# ğŸ”¹ 1ë‹¨ê³„: Gradle ë¹Œë“œ
FROM gradle:8.1.1-jdk17 AS build
WORKDIR /app

# Gradle ìºì‹œ ìµœì í™”
COPY settings.gradle build.gradle gradlew ./
COPY gradle/ ./gradle/
RUN ./gradlew --no-daemon build -x test || true

# ì†ŒìŠ¤ ì½”ë“œ ë³µì‚¬ í›„ ë¹Œë“œ
COPY src/ ./src/
RUN ./gradlew --no-daemon build -x test --build-cache

# ğŸ”¹ 2ë‹¨ê³„: ê²½ëŸ‰í™”ëœ ì‹¤í–‰ ì´ë¯¸ì§€
FROM eclipse-temurin:17-jre-jammy
WORKDIR /app

COPY --from=build /app/build/libs/*.jar app.jar

EXPOSE 8080
ENTRYPOINT ["java", "-jar", "app.jar"]
